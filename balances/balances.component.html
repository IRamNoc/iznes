<div class="header-breadcrumbs">
    <h1><i class="fa fa-th-list"></i><span mltag="txt_balances">Balances</span></h1>
</div>


<clr-tabs *ngIf="tabsControl.length">
    <clr-tab *ngFor="let tabdata of tabsControl; let id = index">
        <button clrTabLink id="testlink{{id}}" [innerHTML]="tabdata.title"></button>
        <clr-tab-content *clrIfActive="tabdata.active">
            <!-- User list tab. -->
            <ng-container *ngIf="id === 0">
                <ng-container
                        *ngTemplateOutlet="staticBalanceList"
                ></ng-container>
            </ng-container>

            <!-- User edit tabs. -->
            <ng-container *ngIf="id >= 1">
                <ng-container
                        *ngTemplateOutlet="dynamicViewTab; context: {'formControl': tabdata.formControl, 'tabid': id, 'asset': tabdata.assetObject, 'template': tabdata.template, 'transaction': tabdata.transaction}"
                ></ng-container>
            </ng-container>
        </clr-tab-content>
    </clr-tab>
</clr-tabs>

<ng-template #staticBalanceList>
    <div class="panel-body">

        <clr-datagrid #myDataGrid>
            <clr-dg-column mltag="txt_actions" style="min-width: 160px;">Actions</clr-dg-column>
            <clr-dg-column mltag="txt_identifier" style="min-width: 150px;">Identifier</clr-dg-column>
            <clr-dg-column mltag="txt_asset" style="min-width: 170px;">Asset</clr-dg-column>
            <clr-dg-column mltag="txt_total" style="min-width: 170px;">Total</clr-dg-column>
            <clr-dg-column mltag="txt_encumbered">Encumbered</clr-dg-column>
            <clr-dg-column mltag="txt_free">Free</clr-dg-column>


            <clr-dg-row *clrDgItems="let asset of assets" [class.flash]="asset.isNew">
                <clr-dg-cell>
                    <div class="btn-group btn-sm">
                        <button (click)="handleView(asset.index)" class="btn">
                            <i class="fa fa-search"></i><span mltag="txt_view">View</span></button>
                        <button class="btn" (click)="handleViewHistory(asset.index)"><i class="fa fa-history"></i><span mltag="txt_history">History</span>
                        </button>
                    </div>
                </clr-dg-cell>
                <clr-dg-cell>{{asset.identifier}}</clr-dg-cell>
                <clr-dg-cell [innerHtml]="asset.asset | asset"></clr-dg-cell>
                <clr-dg-cell [class.flash]="asset.totalChange">
                    {{asset.total | moneyValue}}
                </clr-dg-cell>
                <clr-dg-cell [class.flash]="asset.encumberChange">
                    {{asset.encumbered | moneyValue}}
                </clr-dg-cell>
                <clr-dg-cell [class.flash]="asset.freeChange">
                    {{asset.free | moneyValue}}
                </clr-dg-cell>
            </clr-dg-row>

            <clr-dg-footer>
                {{pagination.firstItem + 1}} - {{pagination.lastItem + 1}}
                <clr-dg-pagination #pagination [clrDgPageSize]="10"></clr-dg-pagination>
            </clr-dg-footer>
        </clr-datagrid>
    </div>
</ng-template>

<!-- User Edit Form. -->
<ng-template #dynamicViewTab let-formControl="formControl" let-tabid="tabid" let-asset="asset" let-template="template" let-transaction="transaction">
    <div class="user-tab-panel-body panel-body">

        <!-- Breakdown view -->
        <div *ngIf="template === 'breakdown'">
            <clr-datagrid #myDataGrid>
                <clr-dg-column mltag="txt_address">Address</clr-dg-column>
                <clr-dg-column mltag="txt_total">Total</clr-dg-column>
                <clr-dg-column mltag="txt_encumbered">Encumbered</clr-dg-column>
                <clr-dg-column mltag="txt_free">Free</clr-dg-column>


                <clr-dg-row *clrDgItems="let breakdown of asset.breakdown">
                    <clr-dg-cell>{{breakdown.address}}</clr-dg-cell>
                    <clr-dg-cell>{{breakdown.total | moneyValue}}</clr-dg-cell>
                    <clr-dg-cell>{{breakdown.encumbered | moneyValue}}</clr-dg-cell>
                    <clr-dg-cell>{{breakdown.free | moneyValue}}</clr-dg-cell>
                </clr-dg-row>

                <clr-dg-footer>
                    {{pagination.firstItem + 1}} - {{pagination.lastItem + 1}}
                    <clr-dg-pagination #pagination [clrDgPageSize]="10"></clr-dg-pagination>
                </clr-dg-footer>
            </clr-datagrid>
        </div>

        <!-- History view -->
        <div *ngIf="template === 'history'">
            <clr-datagrid #myDataGrid>
                <clr-dg-column mltag="txt_action">Action</clr-dg-column>
                <clr-dg-column mltag="txt_tx_id">Tx ID</clr-dg-column>
                <clr-dg-column mltag="txt_asset">Assset</clr-dg-column>
                <clr-dg-column mltag="txt_amount">Amount</clr-dg-column>
                <clr-dg-column mltag="txt_time">Time (UTC)</clr-dg-column>
                <clr-dg-column mltag="txt_type">Type</clr-dg-column>

                <clr-dg-row *clrDgItems="let transaction of transactions">
                    <clr-dg-cell><button (click)="handleViewTransaction(transaction.hash)" class="btn btn-sm"><i class="fa fa-search"></i>View</button></clr-dg-cell>
                    <clr-dg-cell class="tooltip tooltip-xs" [title]="transaction.hash">{{transaction.hash | slice:0:8}}</clr-dg-cell>
                    <clr-dg-cell class="ellipsised" [title]="asset.asset">{{asset.asset | slice:0:8}}...</clr-dg-cell>
                    <clr-dg-cell>{{transaction.amount | moneyValue}}</clr-dg-cell>
                    <clr-dg-cell>{{transaction.utc | date: 'dd/MM/yyyy hh:mm:ss'}}</clr-dg-cell>
                    <clr-dg-cell><span class="label label-success">{{transaction.txType}}</span></clr-dg-cell>
                </clr-dg-row>

                <clr-dg-footer>
                    {{pagination.firstItem + 1}} - {{pagination.lastItem + 1}}
                    <clr-dg-pagination #pagination [clrDgPageSize]="10"></clr-dg-pagination>
                </clr-dg-footer>
            </clr-datagrid>
        </div>

        <!-- Transaction view -->
        <div *ngIf="template === 'transaction'">
            <div class="transaction-tab-panel-body panel-body">
                <form>
                    <div class="form-horizontal">
                        <div class="form-group tx-view-header">
                            <div class="col-sm-3">&nbsp;</div>
                            <label class="col-sm-4">
                                <span class="ml" mltag="txt_transactiondetails">Transaction Details</span>
                            </label>
                        </div>

                        <ng-container *ngFor="let field of transactionFields">
                            <div class="form-group" *ngIf="transaction[field.field]">
                                <label class="col-sm-3 control-label">
                                    <span class="ml" mltag="txt_">{{field.displayName}}</span>
                                </label>
                                <div class="col-sm-9">
                                    <input type="text" class="form-control" readonly="" value="{{transaction[field.field]}}">
                                </div>
                            </div>
                        </ng-container>
                    </div>
                </form>
            </div>
        </div>

        <div class="form-group tx-view-header">
            <button type="button" class="btn btn-primary" (click)="closeTab(tabid)">Close</button>
        </div>
    </div>
</ng-template>


<!--<clr-tab>-->
<!--<button clrTabLink clrTabLinkId="reports-balances"><i class="fa fa-th-list"></i> EUR</button>-->
<!--<clr-tab-content *clrIfActive>-->

<!--</clr-tab-content>-->
<!--</clr-tab>-->

<!--<clr-tab>-->
<!--<button clrTabLink clrTabLinkId="reports-balances"><i class="fa fa-history"></i> EUR History</button>-->
<!--<clr-tab-content *clrIfActive>-->
<!--<clr-datagrid #myDataGrid>-->
<!--<clr-dg-column>Actions</clr-dg-column>-->
<!--<clr-dg-column>Tx ID</clr-dg-column>-->
<!--<clr-dg-column>Asset</clr-dg-column>-->
<!--<clr-dg-column>Amount</clr-dg-column>-->
<!--<clr-dg-column>Time</clr-dg-column>-->
<!--<clr-dg-column>Type</clr-dg-column>-->


<!--<clr-dg-row *clrDgItems="let asset of singleAssetHistory">-->
<!--<clr-dg-cell>-->
<!--<div class="btn-group btn-sm">-->
<!--<button class="btn"><i class="fa fa-search"></i> View</button>-->
<!--</div>-->
<!--</clr-dg-cell>-->
<!--<clr-dg-cell>{{asset.txid}}</clr-dg-cell>-->
<!--<clr-dg-cell>{{asset.asset}}</clr-dg-cell>-->
<!--<clr-dg-cell>{{asset.amount}}</clr-dg-cell>-->
<!--<clr-dg-cell>{{asset.time}}</clr-dg-cell>-->
<!--<clr-dg-cell><span class="label label-success">{{asset.type}}</span></clr-dg-cell>-->
<!--</clr-dg-row>-->

<!--<clr-dg-footer>-->
<!--{{pagination.firstItem + 1}} - {{pagination.lastItem + 1}}-->
<!--<clr-dg-pagination #pagination [clrDgPageSize]="10"></clr-dg-pagination>-->
<!--</clr-dg-footer>-->
<!--</clr-datagrid>-->

<!--</clr-tab-content>-->
<!--</clr-tab>-->
<!--<clr-tab>-->
<!--<button clrTabLink clrTabLinkId="reports-balances"><i class="fa fa-exchange"></i> 35fgughhy87byhiu</button>-->
<!--<clr-tab-content *clrIfActive>-->

<!--<form>-->
<!--<div class="form-horizontal">-->
<!--<div class="row">-->
<!--<div class="form-group col-sm-6">-->
<!--<label class="control-label">-->
<!--<span class="ml_translated" mltag="txt_username">Transaction Type</span>-->
<!--</label>-->
<!--<div>-->
<!--<input type="text" placeholder="Username" class="form-control username mlp_translated" mltag="txt_username">-->
<!--</div>-->
<!--</div>-->

<!--<div class="form-group col-sm-6">-->
<!--<label class="control-label">-->
<!--<span class="ml_translated" mltag="txt_email">Base Chain</span>-->
<!--</label>-->
<!--<div>-->
<!--<input type="email" placeholder="enter email..." class="form-control email mlp_translated" mltag="txt_enteremail">-->
<!--</div>-->
<!--</div>-->
<!--</div>-->

<!--<div class="row">-->
<!--<div class="form-group col-sm-6">-->
<!--<label class="control-label">-->
<!--<span class="ml_translated" mltag="txt_username">Transaction Hash</span>-->
<!--</label>-->
<!--<div>-->
<!--<input type="text" placeholder="Username" class="form-control username mlp_translated" mltag="txt_username">-->
<!--</div>-->
<!--</div>-->

<!--<div class="form-group col-sm-6">-->
<!--<label class="control-label">-->
<!--<span class="ml_translated" mltag="txt_email">From Public Key</span>-->
<!--</label>-->
<!--<div>-->
<!--<input type="email" placeholder="enter email..." class="form-control email mlp_translated" mltag="txt_enteremail">-->
<!--</div>-->
<!--</div>-->
<!--</div>-->

<!--<div class="row">-->
<!--<div class="form-group col-sm-6">-->
<!--<label class="control-label">-->
<!--<span class="ml_translated" mltag="txt_username">From Address</span>-->
<!--</label>-->
<!--<div>-->
<!--<input type="text" placeholder="Username" class="form-control username mlp_translated" mltag="txt_username">-->
<!--</div>-->
<!--</div>-->

<!--<div class="form-group col-sm-6">-->
<!--</div>-->
<!--</div>-->

<!--<div class="row">-->
<!--<div class="form-group col-sm-6">-->
<!--<label class="control-label">-->
<!--<span class="ml_translated" mltag="txt_username">Issuer</span>-->
<!--</label>-->
<!--<div>-->
<!--<input type="text" placeholder="Username" class="form-control username mlp_translated" mltag="txt_username">-->
<!--</div>-->
<!--</div>-->

<!--<div class="form-group col-sm-6">-->
<!--<label class="control-label">-->
<!--<span class="ml_translated" mltag="txt_email">Instrument</span>-->
<!--</label>-->
<!--<div>-->
<!--<input type="email" placeholder="enter email..." class="form-control email mlp_translated" mltag="txt_enteremail">-->
<!--</div>-->
<!--</div>-->
<!--</div>-->

<!--<div class="row">-->
<!--<div class="form-group col-sm-6">-->
<!--<label class="control-label">-->
<!--<span class="ml_translated" mltag="txt_username">To Address</span>-->
<!--</label>-->
<!--<div>-->
<!--<input type="text" placeholder="Username" class="form-control username mlp_translated" mltag="txt_username">-->
<!--</div>-->
<!--</div>-->

<!--<div class="form-group col-sm-6">-->
<!--<label class="control-label">-->
<!--<span class="ml_translated" mltag="txt_email">Amount</span>-->
<!--</label>-->
<!--<div>-->
<!--<input type="email" placeholder="enter email..." class="form-control email mlp_translated" mltag="txt_enteremail">-->
<!--</div>-->
<!--</div>-->
<!--</div>-->

<!--<div class="row">-->
<!--<div class="form-group col-sm-12">-->
<!--<label class="control-label">-->
<!--<span class="ml_translated" mltag="txt_username">Transaction Signature</span>-->
<!--</label>-->
<!--<div>-->
<!--<input type="text" placeholder="Username" class="form-control username mlp_translated" mltag="txt_username">-->
<!--</div>-->
<!--</div>-->
<!--</div>-->


<!--<div class="row">-->
<!--<div class="form-group col-sm-6">-->
<!--<label class="control-label">-->
<!--<span class="ml_translated" mltag="txt_username">Protocol</span>-->
<!--</label>-->
<!--<div>-->
<!--<input type="text" placeholder="Username" class="form-control username mlp_translated" mltag="txt_username">-->
<!--</div>-->
<!--</div>-->

<!--<div class="form-group col-sm-6">-->
<!--<label class="control-label">-->
<!--<span class="ml_translated" mltag="txt_email">Block Height</span>-->
<!--</label>-->
<!--<div>-->
<!--<input type="email" placeholder="enter email..." class="form-control email mlp_translated" mltag="txt_enteremail">-->
<!--</div>-->
<!--</div>-->
<!--</div>-->

<!--<div class="row">-->
<!--<div class="form-group col-sm-6">-->
<!--<label class="control-label">-->
<!--<span class="ml_translated" mltag="txt_username">Coordinated Universal Time</span>-->
<!--</label>-->
<!--<div>-->
<!--<input type="text" placeholder="Username" class="form-control username mlp_translated" mltag="txt_username">-->
<!--</div>-->
<!--</div>-->

<!--<div class="form-group col-sm-6">-->

<!--</div>-->
<!--</div>-->


<!--<div class="row">-->
<!--<div class="form-group col-sm-12">-->
<!--<label class="control-label">-->
<!--<span class="ml_translated" mltag="txt_username">Tx JSON</span>-->
<!--</label>-->
<!--<div>-->
<!--<textarea></textarea>-->
<!--</div>-->
<!--</div>-->

<!--<div class="form-group col-sm-6">-->

<!--</div>-->
<!--</div>-->
<!--</div>-->
<!--</form>-->

<!--</clr-tab-content>-->
<!--</clr-tab>-->
