<div class="login-container">
    <div class="logo-wrap">
        <img id="{{appConfig.logoID}}" src="{{appConfig.logoUrl}}">
    </div>

    <div class="login-inner-wrapper">
        <p class="login-subheading">{{ title }}</p>
        <p class="login-subpara">{{ description }}</p>
        <p class="login-subpara text-grey">{{ 'Please choose a password.' | translate }}</p>

        <form [formGroup]="signupForm" (ngSubmit)="signup(signupForm.value)" [class.error]="!signupForm.valid && signupForm.touched">

            <!-- Username -->
            <div class="form-group">
                <label for="su-username-field">
                    {{ 'Username' | translate }}
                </label>
                <input id="su-username-field" class="form-control" type="text" name="username" disabled
                    [placeholder]="translate.translate('User name')"
                    formControlName="username"
                    [class.error]="hasError('username', 'required')">
            </div>

            <!-- Password -->
            <div class="form-group">
                <div>
                    <label for="su-password-field">
                        {{ 'Password' | translate }}
                        <app-password-tooltip></app-password-tooltip>
                    </label>
                    <div class="toggle-parent">
                        <input id="su-password-field" class="form-control" name="password"
                            [type]="(showPassword) ? 'text' : 'password'"
                            [placeholder]="translate.translate('Password')"
                            formControlName="password"
                            [class.error]="hasError('password', 'required')">

                        <span class="toggle-password" (click)="toggleShowPasswords()" title="Show/hide passwords">
                            <i class="fa fa-eye-slash" aria-hidden="true"></i>
                        </span>
                    </div>
                </div>

                <span *ngIf="hasError('password', 'required')" class="text-danger">
                    {{ 'Field is required' | translate }}
                </span>
                <span *ngIf="hasError('password', 'rules')" class="text-danger">
                    {{ 'Your password does not meet the security criteria' | translate }}
                </span>
            </div>

            <!-- Password confirm -->
            <div class="form-group">
                <div>
                    <label for="su-passwordConfirm-field">
                        {{' Password confirmation' | translate }}
                    </label>

                    <div class="toggle-parent">
                        <input id="su-passwordConfirm-field" class="form-control" name="passwordConfirm"
                            [type]="(showConfirmPassword) ? 'text' : 'password'"
                            [placeholder]="translate.translate('Retype password')"
                            formControlName="passwordConfirm"
                            [class.error]="hasError('passwordConfirm', 'rules')">

                        <span class="toggle-password" (click)="toggleShowPasswords(true)" title="Show/hide passwords">
                            <i class="fa fa-eye-slash" aria-hidden="true"></i>
                        </span>
                    </div>
                </div>

                <span *ngIf="hasError('passwordConfirm', 'required'); else checkMatch" class="text-danger">
                    {{ 'Field is required' | translate }}
                </span>
                <ng-template #checkMatch>
                    <span *ngIf="hasError('', 'mismatch') && isTouched('password') && isTouched('passwordConfirm')" class="text-danger">
                        {{ 'Passwords do not match' | translate }}
                    </span>
                </ng-template>
            </div>

            <div class="form-group">
                <button id="signup-submit" type="submit" class="btn btn-primary block full-width m-b"
                    [disabled]="!signupForm.valid">
                    {{ buttonText }}
                </button>
            </div>
        </form>
    </div>

    <p>
        <small>
            <span class="ml">{{ 'IZNES is a private environment subject to authorised access only.' | translate}}</span>
        </small>
    </p>
</div>

<app-authenticate
    *ngIf="showTwoFactorModal"
    [qrCode]="qrCode"
    (modalCancelled)="showTwoFactorModal=!$event">
</app-authenticate>
