<div class="header-breadcrumbs">
    <h1><i class="fa fa-list"></i> <span mltag="txt_listoffunds">Place an Order</span></h1>
</div>

<div class="wrapper wrapper-content">
    <clr-tabs *ngIf="tabsControl.length">
        <clr-tab *ngFor="let tabdata of tabsControl; let id = index">
            <button clrTabLink id="link{{id}}" [routerLink]="['/list-of-funds', id]">
                <span class="{{tabdata.title.colorClass}}"><i class="fa {{tabdata.title.icon}}"></i> {{tabdata.title.text}}</span>
            </button>

            <clr-tab-content *clrIfActive="tabdata.active">
                <ng-container *ngIf="tabdata.actionType === ''">
                    <ng-container *ngTemplateOutlet="listOfFundsTab"></ng-container>
                </ng-container>

                <ng-container *ngIf="tabdata.actionType === 'subscribe'">
                    <app-invest-fund [shareId]="tabdata.fundShareId" [initialFormData]="tabdata.formData" (formDataChange)="updateFormData(id, $event)" [type]="'subscribe'" (close)="closeTab(id)" [doValidate]="production"></app-invest-fund>
                </ng-container>

                <ng-container *ngIf="tabdata.actionType === 'redeem'">
                    <app-invest-fund [shareId]="tabdata.fundShareId" [initialFormData]="tabdata.formData" (formDataChange)="updateFormData(id, $event)" [type]="'redeem'" (close)="closeTab(id)" [doValidate]="production"></app-invest-fund>
                </ng-container>

                <ng-container *ngIf="tabdata.actionType === 'view'">
                    <app-fund-view [shareId]="tabdata.fundShareId" (close)="closeTab(id)"></app-fund-view>
                </ng-container>

            </clr-tab-content>

        </clr-tab>
    </clr-tabs>

    <!--list of fund tab-->
    <ng-template #listOfFundsTab>
        <div class="panel-body">
            <div class="message_list_menu">
                <clr-datagrid>
                    <clr-dg-column [clrDgField]="'isin'" clrDgSortIcon>ISIN <span class="column-label"></span></clr-dg-column>
                    <clr-dg-column [clrDgField]="'shareName'" clrDgSortIcon>Share Name <span class="column-label"></span></clr-dg-column>
                    <clr-dg-column [clrDgField]="'assetClass'" clrDgSortIcon clrDgSortNoSearch>Asset Class <span class="column-label"></span></clr-dg-column>
                    <clr-dg-column [clrDgField]="'assetManager'" clrDgSortIcon>Asset Manager <span class="column-label"></span></clr-dg-column>
                    <clr-dg-column [clrDgField]="'srri'" clrDgSortIcon clrDgSortNoSearch>SRRI <span class="column-label"></span></clr-dg-column>
                    <clr-dg-column [clrDgField]="'sri'" clrDgSortIcon clrDgSortNoSearch>SRI <span class="column-label"></span></clr-dg-column>
                    <clr-dg-column [clrDgField]="'currency'" clrDgSortIcon clrDgSortNoSearch>Share Currency <span class="column-label"></span></clr-dg-column>
                    <clr-dg-column [clrDgField]="'nav'" clrDgSortIcon>Last NAV <span class="column-label"></span></clr-dg-column>
                    <clr-dg-column [clrDgField]="'subscriptionDate'" clrDgSortIcon>Subscription Cut-off Date <span class="column-label"></span></clr-dg-column>
                    <clr-dg-column [clrDgField]="'redemptionDate'" clrDgSortIcon>Redemption Cut-off Date <span class="column-label"></span></clr-dg-column>
                    <clr-dg-column mltag="txt_actions" style="min-width: 190px;">Actions</clr-dg-column>

                    <clr-dg-row *clrDgItems="let fund of fundList; let i = index">
                        <clr-dg-cell>{{fund['isin']}}</clr-dg-cell>
                        <clr-dg-cell>{{fund['shareName']}}</clr-dg-cell>
                        <clr-dg-cell>{{fund['assetClass']}}</clr-dg-cell>
                        <clr-dg-cell>{{fund['assetManager']}}</clr-dg-cell>
                        <clr-dg-cell>{{fund['srri']}}</clr-dg-cell>
                        <clr-dg-cell>{{fund['sri']}}</clr-dg-cell>
                        <clr-dg-cell>{{fund['currency']}}</clr-dg-cell>
                        <clr-dg-cell>{{fund['nav']}}</clr-dg-cell>
                        <clr-dg-cell>{{fund['subscriptionDate']}}</clr-dg-cell>
                        <clr-dg-cell>{{fund['redemptionDate']}}</clr-dg-cell>
                        <clr-dg-cell>
                            <div class="btn-group btn-sm">
                                <button class="btn text-green" (click)="handleSubscribe(i)">
                                    <i class="fa fa-sign-in"></i> <span mltag="txt_subscribe">Subscribe</span></button>
                                <button class="btn text-red" (click)="handleRedeem(i)">
                                    <i class="fa fa-sign-out"></i> <span mltag="txt_redeem">Redeem</span></button>
                                <button class="btn text-yellow" (click)="handleBuySell(i)">
                                    <i class="fa fa-sign-out"></i> <span mltag="">Sell / Buy</span></button>
                            </div>
                        </clr-dg-cell>
                    </clr-dg-row>

                    <clr-dg-footer>
                        {{pagination.firstItem + 1}} - {{pagination.lastItem + 1}}
                        <clr-dg-pagination #pagination [clrDgPageSize]="10"></clr-dg-pagination>
                    </clr-dg-footer>
                </clr-datagrid>
            </div>

        </div>
    </ng-template>
</div>