<form (ngSubmit)="handleSubmit()" [formGroup]="form" [class.error]="!form.valid && form.touched">
    <div class="form-horizontal">
        <div class="row">
            <div class="form-group col-sm-6">
                <label class="control-label">
                    <span class="ml_translated" mltag="txt_registrar">Registrar</span>
                </label>
                <div>
                    <input type="text" class="form-control mlp_translated" [value]="metaData.registrar" [readonly]="true">
                </div>
            </div>

            <div class="form-group col-sm-6">
                <label class="control-label">
                    <span class="ml_translated" mltag="txt_fundshare">Fund share</span>
                </label>
                <div>
                    <input type="text" class="form-control mlp_translated" [value]="metaData.shareName" [readonly]="true">
                </div>
            </div>
        </div>

        <div class="hr-line-dashed"></div>

        <div class="row">
            <div class="form-group col-sm-6">
                <label class="control-label">
                    <span class="ml_translated" mltag="txt_isincode">ISIN code</span>
                </label>
                <div>
                    <input type="text" class="form-control mlp_translated" [value]="metaData.isin" [readonly]="true">
                </div>
            </div>

            <div class="form-group col-sm-6">
                <label class="control-label">
                    <span class="ml_translated" mltag="txt_currency">Currency</span>
                </label>
                <div>
                    <input type="text" class="form-control mlp_translated" [value]="metaData.currency" [readonly]="true">
                </div>
            </div>

        </div>

        <div class="hr-line-dashed"></div>

        <div class="row">
            <div class="form-group col-sm-6">
                <app-switch-button [value]="actionBy" (updateValue)="actionBy = $event" [config]="{buttonsText: ['Quantity', 'Amount'], disabled:  metaData.allowType !== 'both'}"></app-switch-button>
                <div>
                    <span *ngIf="metaData.allowType === 'both'" class="help-block m-b-none text-success"><i class="fa fa-info-circle" aria-hidden="true"></i> <span class="ml_translated">You can either {{formConfig.actionLabel}} by amount or unit for this fund share</span>.</span>
                    <span *ngIf="metaData.allowType === 'quantity'" class="help-block m-b-none text-success"><i class="fa fa-info-circle" aria-hidden="true"></i> <span class="ml_translated">You can only {{formConfig.actionLabel}}  by quantity for this fund share</span>.</span>
                    <span *ngIf="metaData.allowType === 'amount'" class="help-block m-b-none text-success"><i class="fa fa-info-circle" aria-hidden="true"></i> <span class="ml_translated">You can only {{formConfig.actionLabel}}  by amount for this fund share</span>.</span>
                    <span class="help-block m-b-none text-success" [ngStyle]="{'width': '100%'}"><i class="fa fa-info-circle" aria-hidden="true"></i> <span class="ml_translated" mltag="txt_decimalisation">Decimalisation</span>: <span class="decimalisation">0,00001</span>.</span>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="form-group col-sm-6">
                <label class="control-label">
                    <span class="ml_translated" mltag="txt_quantity">Quantity</span>
                </label>
                <div>
                    <input type="text" formControlName="quantity" class="form-control mlp_translated"
                           [readonly]="actionBy === 1"
                           [class.error]="!form.controls['quantity'].valid && form.controls['quantity'].touched"
                           (focus)="subscribeForChange('quantity')" (blur)="unSubscribeForChange()" appNumberFormatter [fractionSize]="metaData.decimalisation"/>
                </div>
            </div>

            <div class="form-group col-sm-6">
                <label class="control-label">
                    <span class="ml_translated" mltag="txt_subportfolio">Sub-portfolio</span>
                </label>
                <div>
                    <ng-select
                        [class.error]="!form.controls['address'].valid && form.controls['address'].touched"
                        [items]="addressList"
                        [allowClear]="false"
                        placeholder="Select sub-portfolio"
                        formControlName="address"
                        (selected)="handleSelectedAddress($event)"
                    mltag="txt_selectsubportfolio">
                    </ng-select>
                </div>
            </div>

        </div>

        <div class="row">

            <div class="form-group col-sm-6">
                <label class="control-label">
                    <span class="ml_translated" mltag="txt_netassetvalue">Net asset value</span>
                </label>
                <div>
                    <input type="text" class="form-control mlp_translated" [value]="metaData.nav | moneyValue" [readonly]="true">
                </div>
            </div>

            <div class="form-group col-sm-6">
                <label class="control-label">
                    <span class="ml_translated" mltag="txt_grossamount">Gross amount</span>
                </label>
                <div>
                    <input type="text" formControlName="grossAmount" class="form-control mlp_translated"
                           [readonly]="actionBy === 0"
                           [class.error]="!form.controls['grossAmount'].valid && form.controls['grossAmount'].touched"
                           (focus)="subscribeForChange('grossAmount')" (blur)="unSubscribeForChange()" appNumberFormatter>
                </div>
            </div>
        </div>

        <div class="hr-line-dashed"></div>

        <div class="row">
            <div>
                <span *ngIf="!metaData.knownNav" class="help-block m-b-none text-success"><i class="fa fa-info-circle" aria-hidden="true"></i> <span>{{formConfig.actionLabel}} by unknown NAV</span>.</span>
                <span *ngIf="metaData.knownNav" class="help-block m-b-none text-success"><i class="fa fa-info-circle" aria-hidden="true"></i> <span>{{formConfig.actionLabel}} by known NAV</span>.</span>
            </div>
        </div>

        <div class="row">
            <div class="form-group col-sm-6">
                <label class="control-label">
                    <span class="ml_translated" mltag="txt_cutoffdate">Cut-off date</span>
                </label>
                <div class="input-group date-pick-wrapper">
                    <span class="fa fa-calendar" aria-hidden="true"></span>

                    <input [dpDayPicker]="configDate" [value]="metaData.cutoffDateTimeNumber | date:'dd/MM/yyyy' " placeholder="Choose a date" mode="day" theme="dp-material" [ngStyle]="{'width':'100%'}" [disabled]="true" mltag="txt_chooseadate"/>
                </div>
            </div>

            <div class="form-group col-sm-6">
                <label class="control-label">
                    <span class="ml_translated" mltag="txt_valuationdate">Valuation date</span>
                </label>

                <div class="input-group date-pick-wrapper">
                    <span class="fa fa-calendar" aria-hidden="true"></span>

                    <input [dpDayPicker]="configDate" [value]="metaData.valuationDateTimeNumber | date: 'dd/MM/yyyy' " placeholder="Choose a date" mode="day" theme="dp-material" [ngStyle]="{'width':'100%'}" [disabled]="true" mltag="txt_chooseadate"/>
                </div>
            </div>

        </div>


        <div class="row">

            <div class="form-group col-sm-6">
                <label class="control-label">
                    <span class="ml_translated" mltag="txt_settlementdate">Settlement date</span>
                </label>
                <div class="input-group date-pick-wrapper">
                    <span class="fa fa-calendar" aria-hidden="true"></span>

                    <input [dpDayPicker]="configDate" [value]="metaData.settlementDateTimeNumber | date : 'dd/MM/yyyy' " placeholder="Choose a date" mode="day" theme="dp-material" [ngStyle]="{'width':'100%'}" [disabled]="true" mltag="txt_chooseadate"/>
                </div>
            </div>

            <div class="form-group col-sm-6">
                <label class="control-label">
                    <span class="ml_translated">{{formConfig.feeLabel}} fee</span>
                    <span class="text-primary">( {{metaData.feePercent}}% + â‚¬{{metaData.platformFee}} )</span>
                </label>
                <div>
                    <input type="text" class="form-control mlp_translated" [value]="fee | moneyValue" [readonly]="true">
                </div>
            </div>

        </div>


        <div class="row">
            <div class="form-group col-sm-6">
                <label class="control-label">
                    <span class="ml_translated" mltag="txt_comment">Comment</span>
                </label>
                <div>
                    <input type="text" formControlName="comment" class="form-control mlp_translated">
                </div>
            </div>
        </div>

        <div class="hr-line-dashed"></div>

        <div class="row">
            <div class="form-group button-group">
                <div class="col-sm-12">
                    <button type="submit" class="btn btn-primary">
                        <i class="fa fa-save"></i> <span class="ml_translated" mltag="txt_save">Save</span>
                    </button>
                    <button (click)="handleClose()" class="btn btn-secondary" mltag="txt_close"> Close</button>
                </div>
            </div>
        </div>

        <div *ngIf="!form.controls['quantity'].valid && form.controls['quantity'].touched" class="alert-items">

            <div class="alert alert-danger">
                <div class="alert-items">
                    <div class="alert-item">
                <span class="alert-text" mltag="txt_invalidquantity"> Invalid quantity</span>
                    </div>
                </div>
            </div>

        </div>

        <div *ngIf="!form.controls['grossAmount'].valid && form.controls['grossAmount'].touched" class="alert-items">

            <div class="alert alert-danger">
                <div class="alert-items">
                    <div class="alert-item">
                <span class="alert-text" mltag="txt_invalidgrossamount"> Invalid gross amount</span>
                    </div>
                </div>
            </div>

        </div>

        <div *ngIf="!form.controls['comment'].valid && form.controls['comment'].touched" class="alert-items">

            <div class="alert alert-danger">
                <div class="alert-items">
                    <div class="alert-item">
                <span class="alert-text" mltag="txt_commentexceedmaxlength"> Comment exceed max length</span>
                    </div>
                </div>
            </div>

        </div>

        <div *ngIf="!form.controls['address'].valid && form.controls['address'].touched" class="alert-items">

            <div class="alert alert-danger">
                <div class="alert-items">
                    <div class="alert-item">
                <span class="alert-text" mltag="txt_selectasubportfolio"> Select a sub-portfolio</span>
                    </div>
                </div>
            </div>

        </div>

    </div>

</form>

