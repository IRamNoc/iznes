<toaster-container></toaster-container>

<div class="login-container">
    <div>
        <div class="logo-wrap">
            <img id="{{appConfig.logoID}}" src="{{appConfig.logoUrl}}">
        </div>

        <div class="login-inner-wrapper">
            <span class="login-subheading">Log in to {{appConfig.platform}}</span>
            <br>
            <p class="login-subpara">
                <span mltag="txt_pleaseenteryouremailandpassworc2803b59d7">Please enter your email
                and password</span>
                <br>
                to log in to the {{appConfig.platform}} platform
            </p>
            <br>
            <form [formGroup]="loginForm" (ngSubmit)="login(loginForm.value)"
                  [class.error]="!loginForm.valid && loginForm.touched">
                <div class="form-group">
                    <input id="username-field" type="text" name="username" placeholder="Username"
                           class="form-control"
                           formControlName="username"
                           [class.error]="!loginForm.controls['username'].valid && loginForm.controls['username'].touched"
                           mltag="txt_username"
                           #usernameInput
                           >
                    <div *ngIf="!loginForm.controls['username'].valid && loginForm.controls['username'].touched"
                         class="field-error" mltag="txt_thisfieldisrequired">
                        Username is required
                    </div>
                </div>

                <div class="form-group">
                    <input id="password-field" name="password" type="password" class="form-control"
                           placeholder="Password" formControlName="password"
                           [class.error]="!loginForm.controls['password'].valid && loginForm.controls['password'].touched"
                           mltag="txt_password"
                           #passwordInput>
                    <div *ngIf="!loginForm.controls['password'].valid && loginForm.controls['password'].touched"
                         class="field-error" mltag="txt_thisfieldisrequired">
                        Password is required
                    </div>
                </div>

                <div class="form-group">
                    <button id="login-submit" type="submit" class="btn btn-primary block full-width m-b"
                            mltag="txt_login">
                        Login
                    </button>
                </div>

            </form>

            <p class="mt-1">
                <span class="ml"><a id="forgotten-password-link" [ngStyle]="{'cursor':'pointer'}"
                                    (click)="showFPModal()" mltag="txt_forgotyourpassword">
                        Forgot your password?

                    </a></span>
            </p>
        </div>

        <p>
            <small>
                <span class="ml" mltag="txt_setlopencsdisaprivateenvironmef13e518332">SETL OpenCSD is a private
                    environment subject to authorised access only.</span>
            </small>
        </p>
    </div>
</div>

<!--CUSTOM TEXT MODALS-->
<clr-modal [(clrModalOpen)]="showModal" [clrModalClosable]="false">
    <h3 class="modal-title" *ngIf="(!emailSent || isTokenExpired) && !changePassword" mltag="txt_forgottenpassword">
        Forgotten password?

    </h3>
    <h3 class="modal-title" *ngIf="emailSent && !changePassword" mltag="txt_emailsent">Email sent</h3>
    <h3 class="modal-title" *ngIf="changePassword" mltag="txt_changeyourpassword">Change your password</h3>
    <div class="modal-body text-center" *ngIf="!emailSent && !changePassword">
        <div *ngIf="isTokenExpired; else notExpired" class="text-center">
            <span class="text-danger" mltag="txt_thislinkhasexpired">This link has expired!</span>
            <p><i class="fa fa-exclamation fa-5x text-danger" aria-hidden="true"></i></p>
            <p mltag="txt_pleaseretypeyouremailaddressto923aeb5a06">Please retype your email address to change your
                password.

            </p>
        </div>
        <ng-template #notExpired>
            <p mltag="txt_pleaseenteryouremailaddress">Please enter your email address.</p>
            <i class="fa fa-envelope-o fa-5x text-muted" aria-hidden="true"></i>
        </ng-template>
        <form [formGroup]="forgottenPasswordForm" novalidate (ngSubmit)="sendEmail(forgottenPasswordForm.value)">
            <section class="form-block">
                <div class="form-group text-center">
                    <input id="fp-email-field" type="text" class="form-control" formControlName="email"
                           placeholder="Email address" mltag="txt_emailaddress">


                    <div [ngStyle]="{'height':'24px'}">
                        <div *ngIf="forgottenPasswordForm.controls.email.hasError('required') && forgottenPasswordForm.controls.email.dirty"
                             class="text-danger" mltag="txt_thisfieldisrequired">
                            This field is required

                        </div>

                        <div *ngIf="!forgottenPasswordForm.controls.email.valid && !forgottenPasswordForm.controls.email.hasError('required')"
                             class="text-danger" mltag="txt_emailnotvalid">
                            Email not valid!

                        </div>
                    </div>
                </div>

                <div class="text-center">
                    <small mltag="txt_ifyouclicksendanemailwillbesenb5646984c0">If you click Send, an email will be sent
                        to this address.

                    </small>
                </div>

                <div class="text-center mt-1">
                    <button id="fp-cancel-sendemail-button" class="btn btn-info" type="button" (click)="closeFPModal()">
                        <span mltag="txt_cancel">Cancel</span>
                    </button>

                    <button id="fp-submit-sendemail-button" type="submit" class="btn btn-success"
                            [disabled]="!forgottenPasswordForm.valid">

                        <span mltag="txt_send">Send</span>
                    </button>
                </div>
            </section>
        </form>
    </div>

    <div class="modal-body text-center" *ngIf="emailSent && !changePassword">
        <p><span mltag="txt_anemailhasbeensenttotheemailade85cadbb5a">An email has been sent to the email address</span>:<br><b
                [ngStyle]="{'color':'#62a420'}">
            {{emailUser}}
        </b></p>
        <br>
        <i class="fa fa-paper-plane-o fa-5x" aria-hidden="true"></i>
        <br><br>This pop-up will automatically close in {{countdown}} seconds.

        <br><br>
        <button id="fp-newpassword-close-button" class="btn btn-info" type="button" (click)="closeFPModal()">
            <span mltag="txt_close">Close</span>
        </button>
        <br><br>
    </div>

    <div class="modal-body text-center" *ngIf="changePassword">
        <p mltag="txt_pleasetypeapassword">Please type a password</p>
        <br>
        <i class="fa fa-key fa-5x" [ngStyle]="{'color':'#62a420'}" aria-hidden="true"></i>
        <br><br>
        <form [formGroup]="changePasswordForm" novalidate (ngSubmit)="saveNewPassword(changePasswordForm.value)">
            <section class="form-block">
                <div class="form-group">
                    <div>
                        <input id="fp-password-field" [type]="(showPasswords1 === true) ? 'text' : 'password'"
                               class="form-control" formControlName="password" size="45" placeholder="New password"
                               mltag="txt_newpassword">


                        <span style="margin-top: -45px !important; position: absolute; right: 15px; font-size: 18px; line-height: 2em; color: grey; cursor:pointer;"
                              (click)="toggleShowPasswords(1)" title="Show/hide passwords">


                            <i class="fa fa-eye-slash" aria-hidden="true">
                            </i></span>
                    </div>
                    <div [ngStyle]="{'height':'24px'}">
                        <div *ngIf="changePasswordForm.controls.password.hasError('required') && changePasswordForm.controls.password.dirty"
                             class="text-danger" mltag="txt_passwordisrequired">
                            Password is required

                        </div>
                        <div *ngIf="!changePasswordForm.controls.password.valid && !changePasswordForm.controls.password.hasError('required') && changePasswordForm.controls.password.touched"
                             class="text-danger" mltag="txt_yourpasswordmustbeatleast6chard618084a6b">
                            Your password must be at least 6 characters


                        </div>
                    </div>
                </div>
                <div class="form-group text-center">
                    <div>
                        <input id="fp-passwordconfirm-field" [type]="(showPasswords2 === true) ? 'text' : 'password'"
                               class="form-control" formControlName="passwordConfirm"
                               placeholder="Password confirmation" mltag="txt_passwordconfirmation">


                        <span style="margin-top: -45px !important; position: absolute; right: 15px; font-size: 18px; line-height: 2em; color: grey; cursor:pointer;"
                              (click)="toggleShowPasswords(2)" title="Show/hide passwords">


                            <i class="fa fa-eye-slash" aria-hidden="true">
                            </i></span>
                    </div>
                    <div [ngStyle]="{'height':'24px'}">
                        <div *ngIf="changePasswordForm.controls.passwordConfirm.hasError('required') && changePasswordForm.controls.passwordConfirm.dirty"
                             class="text-danger" mltag="txt_confirmationisrequired">
                            Confirmation is required

                        </div>
                        <div *ngIf="changePasswordForm.controls.passwordConfirm.hasError('minlength') && !changePasswordForm.controls.passwordConfirm.hasError('required') && changePasswordForm.controls.passwordConfirm.dirty"
                             class="text-danger" mltag="txt_yourpasswordmustbeatleast6chard618084a6b">
                            Your password must be at least 6 characters


                        </div>
                        <div *ngIf="!changePasswordForm.controls.passwordConfirm.hasError('minlength') && changePasswordForm.hasError('mismatch') && changePasswordForm.controls.password.valid && !changePasswordForm.controls.passwordConfirm.hasError('required') && changePasswordForm.controls.passwordConfirm.dirty"
                             class="text-danger" mltag="txt_passworddoesnotmatch">
                            Password does not match


                        </div>
                    </div>
                </div>
                <div class="text-center mt-1">
                    <button id="fp-newpassword-cancel-button" class="btn btn-info" type="button"
                            (click)="closeFPModal()">


                        <span mltag="txt_cancel">Cancel</span>
                    </button>
                    <button id="fp-newpassword-submit-button" type="submit" class="btn btn-success"
                            [disabled]="!changePasswordForm.valid">


                        <span mltag="txt_validate">Validate</span>
                    </button>
                </div>
            </section>
        </form>
    </div>
</clr-modal>