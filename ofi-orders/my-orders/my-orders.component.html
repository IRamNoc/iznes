<div class="header-breadcrumbs">
    <h1 id="my-orders"><i class="fa fa-list-ul"></i>{{'My Orders - @connectedWalletName@' | translate: {'connectedWalletName': connectedWalletName} }}
    </h1>
</div>

<div class="wrapper wrapper-content">

    <clr-tabs *ngIf="tabsControl.length">
        <clr-tab *ngFor="let tabdata of tabsControl; let id = index">
            <button clrTabLink id="-{{id}}" [routerLink]="['/order-book/my-orders', id]"><i class="fa {{tabdata.title.icon}}"></i> {{tabdata.title.text}}</button>
            <clr-tab-content *clrIfActive="tabdata.active">
                <ng-container *ngIf="id === 0">
                    <!-- Coupon Payment list tab. -->
                    <ng-container *ngTemplateOutlet="staticOrdersList">

                    </ng-container>
                </ng-container>

                <ng-container *ngIf="id >= 1">
                    <!-- Create Coupon Payment tab. -->
                    <ng-container *ngTemplateOutlet="dynamicViewOrder; context: {'orderData': tabdata.orderData, 'tabid': id}">

                    </ng-container>
                </ng-container>
            </clr-tab-content>
        </clr-tab>
    </clr-tabs>

    <!-- Orders Data Table. -->
    <ng-template #staticOrdersList>
        <div class="panel-body">

            <form id="search-orders-form">
                <div class="row bordered form-group">
                    <div class="col-sm-4">
                        <label>{{'Share Name' | translate}}

                        </label>
                        <div class="input-button-group">
                            <input id="orders-search-fundname" (keyup)="requestSearch()" [formControl]="tabsControl[0].searchForm.controls['name']" name="search-sharename" type="text" [placeholder]="_translate.translate('Share Name')">
                            <button (click)="requestSearch()" style="margin-top: 0 !important"><i class="fa fa-search"></i></button>
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <label>{{'Status' | translate}}

                        </label>
                        <div>
                            <ng-select id="orders-search-status" class="fluid-width" [items]="orderStatuses" [allowClear]="true" (selected)="getOrdersBySearch(false, $event)" (removed)="getOrdersBySearch(false, $event)" [formControl]="tabsControl[0].searchForm.controls['status']" [placeholder]="_translate.translate('Status')">
                            </ng-select>
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <label>{{'Type' | translate}}

                        </label>
                        <div>
                            <ng-select id="orders-search-type" class="fluid-width" [active]="" [items]="orderTypes" [allowClear]="true" (selected)="getOrdersBySearch()" (removed)="getOrdersBySearch()" [formControl]="tabsControl[0].searchForm.controls['type']" [placeholder]="_translate.translate('Type')">
                            </ng-select>
                        </div>
                    </div>
                </div>

                <br>

                <clr-datagrid #ordersDataGrid>
                    <clr-dg-column [clrDgField]="'orderRef'">
                        <ng-container *clrDgHideableColumn="{hidden: false}">{{'Order Ref' | translate}}

                        </ng-container>
                    </clr-dg-column>
                    <clr-dg-column>
                        <ng-container *clrDgHideableColumn="{hidden: false}">{{'Order Type' | translate}}

                        </ng-container>
                    </clr-dg-column>
                    <clr-dg-column [clrDgField]="'shareName'">
                        <ng-container *clrDgHideableColumn="{hidden: false}">{{'Share Name' | translate}}

                        </ng-container>
                    </clr-dg-column>
                    <clr-dg-column [clrDgField]="'assetManagementCompany'">
                        <ng-container *clrDgHideableColumn="{hidden: true}">{{'Asset Management Company' | translate}}

                        </ng-container>
                    </clr-dg-column>
                    <clr-dg-column>
                        <ng-container *clrDgHideableColumn="{hidden: false}">{{'Share Currency' | translate}}

                        </ng-container>
                    </clr-dg-column>
                    <clr-dg-column [clrDgField]="'quantity'">
                        <ng-container *clrDgHideableColumn="{hidden: false}">{{'Quantity' | translate}}

                        </ng-container>
                    </clr-dg-column>
                    <clr-dg-column [clrDgField]="'latestNAV'">
                        <ng-container *clrDgHideableColumn="{hidden: true}">{{'Latest NAV' | translate}}

                        </ng-container>
                    </clr-dg-column>
                    <clr-dg-column [clrDgField]="'grossAmount'">
                        <ng-container *clrDgHideableColumn="{hidden: false}">{{'Gross Amount' | translate}}

                        </ng-container>
                    </clr-dg-column>
                    <clr-dg-column [clrDgField]="'feesAmount'">
                        <ng-container *clrDgHideableColumn="{hidden: true}">{{'Fees Amount' | translate}}

                        </ng-container>
                    </clr-dg-column>
                    <clr-dg-column [clrDgField]="'orderDate'">
                        <ng-container *clrDgHideableColumn="{hidden: false}">{{'Order Date' | translate}}

                        </ng-container>
                    </clr-dg-column>
                    <clr-dg-column [clrDgField]="'cutOffDate'">
                        <ng-container *clrDgHideableColumn="{hidden: false}">{{'Cut-off Date' | translate}}

                        </ng-container>
                    </clr-dg-column>
                    <clr-dg-column [clrDgField]="'navDate'">
                        <ng-container *clrDgHideableColumn="{hidden: true}">{{'NAV Date' | translate}}

                        </ng-container>
                    </clr-dg-column>
                    <clr-dg-column [clrDgField]="'settlementDate'">
                        <ng-container *clrDgHideableColumn="{hidden: false}">{{'Settlement Date' | translate}}

                        </ng-container>
                    </clr-dg-column>
                    <clr-dg-column>
                        <ng-container *clrDgHideableColumn="{hidden: false}">{{'Status' | translate}}

                        </ng-container>
                    </clr-dg-column>
                    <!-- ACTIONS -->
                    <clr-dg-column>{{'Action' | translate}}</clr-dg-column>

                    <!--<clr-dg-column style="min-width: 180px;"><span mltag="txt_investor">Investor</span></clr-dg-column>-->
                    <!--<clr-dg-column style="min-width: 120px;"><span mltag="txt_ordertype">Order type</span>-->
                    <!--</clr-dg-column>-->
                    <!--<clr-dg-column style="min-width: 210px;"><span mltag="txt_fundname">Fund name</span></clr-dg-column>-->
                    <!--<clr-dg-column><span mltag="txt_quantity">Quantity</span></clr-dg-column>-->
                    <!--<clr-dg-column><span mltag="txt_amount">Amount</span></clr-dg-column>-->
                    <!--<clr-dg-column><span mltag="txt_price">Price</span></clr-dg-column>-->
                    <!--<clr-dg-column><span mltag="txt_cutoffdate">Cut-off date</span></clr-dg-column>-->
                    <!--<clr-dg-column><span mltag="txt_deliverydate">Delivery date</span></clr-dg-column>-->
                    <!--<clr-dg-column style="min-width: 100px;"><span mltag="txt_status">Status</span></clr-dg-column>-->


                    <clr-dg-row *clrDgItems="let order of ordersList">
                        <clr-dg-cell>
                            <!-- orderRef -- mltag="txt_yo">Yo

                        </clr-dg-cell>
                        <clr-dg-cell>
                            <!-- orderType -- mltag="txt_yo">Yo

                        </clr-dg-cell>
                        <clr-dg-cell>
                            <!-- shareName -- mltag="txt_yo">Yo

                        </clr-dg-cell>
                        <clr-dg-cell>
                            <!-- assetManagementCompany -- mltag="txt_yo">Yo

                        </clr-dg-cell>
                        <clr-dg-cell>
                            <!-- shareCurrency -- mltag="txt_yo">Yo

                        </clr-dg-cell>
                        <clr-dg-cell>
                            <!-- quantity -- mltag="txt_yo">Yo

                        </clr-dg-cell>
                        <clr-dg-cell>
                            <!-- latestNAV -- mltag="txt_yo">Yo

                        </clr-dg-cell>
                        <clr-dg-cell>
                            <!-- grossAmount -- mltag="txt_yo">Yo

                        </clr-dg-cell>
                        <clr-dg-cell>
                            <!-- feesAmount -- mltag="txt_yo">Yo

                        </clr-dg-cell>
                        <clr-dg-cell>
                            <!-- orderDate -- mltag="txt_yo">Yo

                        </clr-dg-cell>
                        <clr-dg-cell>
                            <!-- cutOffDate -- mltag="txt_yo">Yo

                        </clr-dg-cell>
                        <clr-dg-cell>
                            <!-- navDate -- mltag="txt_yo">Yo

                        </clr-dg-cell>
                        <clr-dg-cell>
                            <!-- settlementDate -- mltag="txt_yo">Yo

                        </clr-dg-cell>
                        <clr-dg-cell>
                            <!-- status -- mltag="txt_yo">Yo

                        </clr-dg-cell>
                        <clr-dg-cell>
                            <!-- Actions -->

                            <button type="button" class="btn btn-info">{{'Cancel' | translate}}</button>
                        </clr-dg-cell>
                        <clr-dg-row-detail *clrIfExpanded>
                            <div class="additionalInfos">
                                <b>{{'Additional informations:' | translate}}</b>
                                <br><br>
                                <table>
                                    <tr>
                                        <th>{{'Asset Management Company' | translate}}</th>
                                        <th>{{'Latest NAV' | translate}}</th>
                                        <th>{{'Fees Amount' | translate}}</th>
                                        <th>{{'NAV Date' | translate}}</th>
                                    </tr>
                                    <tr>
                                        <td>{{'Yo' | translate}}</td>
                                        <td>{{'Yo' | translate}}</td>
                                        <td>{{'Yo' | translate}}</td>
                                        <td>{{'Yo' | translate}}</td>
                                    </tr>
                                </table>
                            </div>
                        </clr-dg-row-detail>

                        <!--<clr-dg-cell>-->
                        <!--&lt;!&ndash; Action &ndash;&gt;-->
                        <!--<div class="btn-group btn-sm compact">-->
                        <!--&lt;!&ndash; If order status is 1, allow cancel. &ndash;&gt;-->
                        <!--<button *ngIf="order.status == 1" id="order-cancel-{{order.arrangementID}}" (click)="handleCancelOrder(order.arrangementID)" class="btn">-->
                        <!--<i class="fa fa-times"></i>-->
                        <!--</button>-->
                        <!--&lt;!&ndash; else, disable cancel. &ndash;&gt;-->
                        <!--<button *ngIf="order.status != 1" id="order-cancel-{{order.arrangementID}}" class="btn" disabled="disabled">-->
                        <!--<i class="fa fa-times"></i>-->
                        <!--</button>-->

                        <!--&lt;!&ndash; View order. &ndash;&gt;-->
                        <!--<button id="order-view-{{order.arrangementID}}" (click)="handleViewOrder(order.arrangementID)" class="btn">-->
                        <!--<i class="fa fa-search"></i>-->
                        <!--</button>-->
                        <!--</div>-->
                        <!--</clr-dg-cell>-->
                        <!--<clr-dg-cell>-->
                        <!--&lt;!&ndash; Investor &ndash;&gt;-->
                        <!--{{ order.metaData.investorSubPortfolio }}-->
                        <!--<b class="text_small">Ref</b> {{ padNumberLeft(order.arrangementID, 5) }}-->
                        <!--</clr-dg-cell>-->
                        <!--<clr-dg-cell>-->
                        <!--&lt;!&ndash; Order type &ndash;&gt;-->
                        <!--<span *ngIf="order.type == 3" class="label label-info" mltag="txt_subscription"> Subscription</span>-->
                        <!--<span *ngIf="order.type == 4" class="label label-success" mltag="txt_redemption"> Redemption</span>-->
                        <!--</clr-dg-cell>-->
                        <!--<clr-dg-cell>-->
                        <!--&lt;!&ndash; Fund name &ndash;&gt;-->
                        <!--{{ order.metaData.assetISIN }}<br/>-->
                        <!--<span class="text_small">{{ order.asset }}</span>-->
                        <!--</clr-dg-cell>-->
                        <!--<clr-dg-cell>-->
                        <!--&lt;!&ndash; Quantity &ndash;&gt;-->
                        <!--{{ order.metaData.units | moneyValue: 5}}-->
                        <!--</clr-dg-cell>-->
                        <!--<clr-dg-cell>-->
                        <!--&lt;!&ndash; Amount &ndash;&gt;-->
                        <!--{{ order.metaData.total | moneyValue: 4}}-->
                        <!--</clr-dg-cell>-->
                        <!--<clr-dg-cell>-->
                        <!--&lt;!&ndash; Price &ndash;&gt;-->
                        <!--{{ order.price | moneyValue: 2}}-->
                        <!--</clr-dg-cell>-->
                        <!--<clr-dg-cell>-->
                        <!--&lt;!&ndash; Cut-off date &ndash;&gt;-->
                        <!--{{ order.cutoffDateStr }} <br>-->
                        <!--<span class="text_small">{{ order.cutoffTimeStr}}</span>-->
                        <!--</clr-dg-cell>-->
                        <!--<clr-dg-cell>-->
                        <!--&lt;!&ndash; Delivery date &ndash;&gt;-->
                        <!--{{ order.deliveryDateStr }}-->
                        <!--</clr-dg-cell>-->
                        <!--<clr-dg-cell>-->
                        <!--&lt;!&ndash; Status &ndash;&gt;-->
                        <!--<span *ngIf="order.status == 1" class="label label-warning">-->
                        <!--<span class="txt_initiated" mltag="txt_initiated">Initiated</span>-->
                        <!--</span>-->

                        <!--<span *ngIf="order.status == 2" class="label label-info">-->
                        <!--<span class="ml" mltag="txt_waitingfornav">Waiting for NAV</span>-->
                        <!--</span>-->

                        <!--<span *ngIf="order.status == 3" class="label label-info">-->
                        <!--<span class="txt_waitingnav" mltag="txt_waitingforsettlement">Waiting for settlement</span>-->
                        <!--</span>-->

                        <!--<span *ngIf="order.status == 0" class="label label-error">-->
                        <!--<span class="ml" mltag="txt_cancelled">Cancelled</span>-->
                        <!--</span>-->

                        <!--<span *ngIf="order.status == -1" class="label label-success">-->
                        <!--<span class="ml" mltag="txt_ordersettled">Order settled</span>-->
                        <!--</span>-->

                        <!--<span *ngIf="order.status == -2" class="label label-error">-->
                        <!--<span class="ml" mltag="txt_orderexpired">Order expired</span>-->
                        <!--</span>-->
                        <!--</clr-dg-cell>-->
                    </clr-dg-row>

                    <clr-dg-footer>
                        <!-- Optional customization of hide/show columns toggle -->
                        <clr-dg-column-toggle>
                            <clr-dg-column-toggle-title>{{'Show/hide fields:' | translate}}

                            </clr-dg-column-toggle-title>
                            <!--<clr-dg-column-toggle-button clrType="selectAll">-->
                            <!--<button type="button" class="btn btn-primary">-->
                            <!--Select All-->
                            <!--</button>-->
                            <!--</clr-dg-column-toggle-button>-->
                            <clr-dg-column-toggle-button clrType="ok">
                                <button type="button" class="btn btn-primary" style="padding:0 20px">
                                    <clr-icon shape="check"></clr-icon>
                                </button>
                            </clr-dg-column-toggle-button>
                        </clr-dg-column-toggle>{{pagination.firstItem + 1}} - {{pagination.lastItem + 1}}

                        <clr-dg-pagination #pagination [clrDgPageSize]="10" [(clrDgPage)]="datagridPage"></clr-dg-pagination>
                    </clr-dg-footer>
                </clr-datagrid>
            </form>
        </div>
    </ng-template>

    <!-- Orders Data Table. -->
    <ng-template #dynamicViewOrder let-orderData="orderData" let-tabid="tabid">
        <div class="panel-body">

            <form id="view-order-form">
                <div class="row form-group">
                    <div class="col-sm-12">
                        <div>
                            <!-- Order type -->
                            <h2 *ngIf="orderData.type == 3">{{'Subscription' | translate}}</h2>
                            <h2 *ngIf="orderData.type == 4">{{'Redemption' | translate}}</h2>
                        </div>
                    </div>
                </div>

                <hr class="dashed">

                <div class="row form-group">
                    <div class="col-sm-6">
                        <label>{{'Registrar' | translate}}

                        </label>
                        <div>
                            <span class="readonly-field">{{orderData.metaData.registrar}}</span>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <label>{{'Fund share' | translate}}

                        </label>
                        <div>
                            <span class="readonly-field">{{orderData.asset}}</span>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <label>{{'ISIN Code' | translate}}

                        </label>
                        <div>
                            <span class="readonly-field">{{orderData.metaData.assetISIN}}</span>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <label>{{'Currency' | translate}}

                        </label>
                        <div>
                            <span class="readonly-field">{{orderData.metaData.currency}}</span>
                        </div>
                    </div>
                </div>

                <hr class="dashed">

                <div class="row form-group">
                    <div class="col-sm-6">
                        <label>{{'Quantity' | translate}}

                        </label>
                        <div>
                            <span class="readonly-field">{{orderData.metaData.units | moneyValue: 5}}</span>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <label>{{'Net Asset Value' | translate}}

                        </label>
                        <div>
                            <span class="readonly-field">{{orderData.price | moneyValue: 2}}</span>
                        </div>
                    </div>
                </div>

                <hr class="dashed">

                <div class="row form-group">
                    <div class="col-sm-6">
                        <label>{{'Gross Amount' | translate}}

                        </label>
                        <div>
                            <span class="readonly-field">{{orderData.metaData.total | moneyValue: 4}}</span>
                        </div>
                    </div>
                </div>

                <hr class="dashed">

                <div class="row form-group">
                    <div class="col-sm-12">
                        <label>{{'Cut-Off Date' | translate}}

                        </label>
                    </div>
                    <div class="col-sm-6">{{'Date' | translate}}

                        <div>
                            <span class="readonly-field">{{ getOrderDate( orderData.cutoffDate ) }}</span>
                        </div>
                    </div>
                    <div class="col-sm-6">{{'Time' | translate}}

                        <div>
                            <span class="readonly-field">{{ getOrderTime( orderData.cutoffDate ) }}</span>
                        </div>
                    </div>
                </div>

                <hr class="dashed">

                <div class="row form-group">
                    <div class="col-sm-6">
                        <label>{{'Valuation Date' | translate}}

                        </label>
                        <div>
                            <span class="readonly-field">{{ getOrderDate( orderData.valuationDate ) }}</span>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <label>{{'Settlement Date' | translate}}

                        </label>
                        <div>
                            <span class="readonly-field">{{ getOrderDate( orderData.deliveryDate ) }}</span>
                        </div>
                    </div>
                </div>

                <hr class="dashed">

                <div class="row form-group">
                    <div class="col-sm-6">
                        <label>{{'Entry Fee (3.75%)' | translate}}

                        </label>
                        <div>
                            <span class="readonly-field">{{ calcEntryFee((orderData.metaData.units * orderData.price)) | moneyValue: 5 }}</span>
                        </div>
                    </div>

                    <div class="col-sm-6">
                        <label>{{'Comment' | translate}}

                        </label>
                        <div>
                            <span class="readonly-field">{{ orderData.metaData.ref }}</span>
                        </div>
                    </div>
                </div>

                <hr class="dashed">

                <div class="form-group button-group">
                    <div class="col-sm-12">
                        <a (click)="closeTab(tabid)" class="btn btn-secondary">{{'Close' | translate}}</a>
                        <button *ngIf="orderData.status == 1" id="order-cancel-{{orderData.arrangementID}}" (click)="handleCancelOrder(orderData.arrangementID)" class="btn btn-warning">{{'Cancel' | translate}}</button>
                    </div>
                </div>
            </form>

        </div>
    </ng-template>

</div>